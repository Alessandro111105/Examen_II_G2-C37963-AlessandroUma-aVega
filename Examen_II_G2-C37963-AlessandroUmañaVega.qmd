---
title: "Examen_II_G2-C37963-AlessandroUma-aVega"
author: "Alessandro Umaña Vega"
format: html
editor: visual
---
#Librerías
```{r}
#se agrega las librerías que se usarán
library(readr)
library(tidyverse)
```
 
#Carga la base de datos
```{r}
#se carga el archivo excel y se pone que el salario es una variable de tipo character para que aparezca la coma de los salarios
moras <- read_csv("C:/Users/aless/OneDrive/Escritorio/Cursos de computación/Herramientas de Datos I/Examen virtual 2/moras.txt", 
    col_types = cols(SALARIO = col_character()))

#se usa la funcion gsub para cambiar la coma por un punto y despues se pone la columna que se quiere cambiar
moras$SALARIO <- gsub(",", ".", moras$SALARIO)

#se cambia el tipo de variable de la columna a una de tipo numérico
moras$SALARIO <- as.numeric(moras$SALARIO)
view(moras)
```

#Resumen 5 números
```{r}
#se crea resumen donde se calculara las 5 variables usando summary y select para que resuma solamente las variables que se deseen.
resumen <- moras %>%
  select(c(SALARIO, EDAD)) %>%
  summary()
resumen


  
```

#Z-score
```{r}
#con mutate se creara las dos columnas con los valores atípicos haciendo uso de funciones como mean y sd para calcular la desviación estandar, también se usará la funcion abs para sacar el valor absoluto del resultado del z-score.

#note que en R los valores faltantes no son 0 en como en excel son NA, por lo que al calcular su z-score seguirán siendo NA
moras <- moras %>%
  mutate(
    z_salario =(moras$SALARIO-mean(moras$SALARIO, na.rm = TRUE))/ sd(moras$SALARIO, na.rm = TRUE),
    z_edad =(moras$EDAD-mean(moras$EDAD, na.rm = TRUE))/ sd(moras$EDAD, na.rm = TRUE)
  )

#ahora con esas variables ya creadas se crearan las variables para verificiar si son mayores o menores a 1,96 que retornará un true o false
moras <- moras %>%
  mutate(
    atipico_salario=(abs(z_salario) > 1.96),
    atipico_edad=(abs(z_edad) > 1.96)
  )

view(moras)
```


#Porcentaje valores faltantes
```{r}
#con col sums y is.na se calculara los na por columnas que hay en todas las columnas y adimas se divide por la cantidad de filas que hay y se multiplica por 100 para que quede en porcentaje
colSums(is.na(moras))/nrow(moras)*100
```
#Imputando los valores faltantes
```{r}
#usamos la funcion mean y is.na para imputar por la media los valores faltantes de la columna edad y salario
moras$SALARIO[is.na(moras$SALARIO)] <- mean(moras$SALARIO, na.rm = TRUE)
moras$EDAD[is.na(moras$EDAD)] <- mean(moras$EDAD, na.rm = TRUE)

#se calcula la moda de los tipos de aseguramientos
moda <- function(x) {
  #crear una tabla donde nos diga la cantidad de veces que aparece cada tipo de aseguramiento
  tabla <- table(x)
  #encontrar la frecuencia máxima de cata tipo de aseguramiento
  freq_max <- max(tabla)
  #devuelve el tipo de aseguramiento con más repeticiones, donde lo que hace es crear un vector lógico que devuelve cuál de los diferentes tipos de aseguramiento es el que tiene más frecuencia.
  moda_valor <- names(tabla)[tabla == freq_max]
  #si hay varias modas, devuelve la primera que se ecnontró
  return(moda_valor[1])
}

#se crea la variable moda_tipo donde se utiliza la funcion creada anteriormente y se pone de criterio la columna tipo aseguramiento para poder calcular la moda
#después lo que hacemos es con is.na decimos que los valores faltantes en esta columna se van a reemplazar con la moda que se encontro en la línea de arriba
moda_tipo <- moda(moras$TIPO_ASEGURAMIENTO)
moras$TIPO_ASEGURAMIENTO[is.na(moras$TIPO_ASEGURAMIENTO)] <- moda_tipo
view(moras)
```

